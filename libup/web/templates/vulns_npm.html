{% extends "base.html" %}
{% block subtitle %}vulnerabilities in npm dependencies{% endblock %}
{% block main %}
<h1>vulnerabilities in npm dependencies</h1>
<blockquote>
    <p>
        ugh, npm.
    </p>
</blockquote>

{% for advisory in advisories.values() %}
<h3>#{{advisory.id}}: {{advisory.module_name}}</h3>
<p>Severity: {{advisory.severity}}</p>
<blockquote class="bg-{{COLORS[SEVERITIES.index(advisory.severity)]}}">
    {{markdown(advisory.overview)|safe}}
    <footer>
        <a href="https://npmjs.com/advisories/{{advisory.id}}">npm advisory</a>
    </footer>
</blockquote>
<h5>Affected repositories ({{len(affected[advisory.id])}})</h5>
<ul>
{% for repo, info in sorted(affected[advisory.id].items()) %}
    <li>
        {{repo_icons(repo)}}
        <a href="{{url_for('r', repo=repo)}}">{{repo}}</a>
        ({% if dev_all(info.findings) %}dev only{% endif %}, via:
        {% for pkg in via(info.findings) %}
        <a href="{{url_for('library_', manager='npm', name=pkg)}}">{{pkg}}</a>,
        {% endfor %}
        )
    </li>
{% endfor %}
</ul>
{% endfor %}

{% endblock %}
